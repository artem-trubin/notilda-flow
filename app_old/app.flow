import material/material;

import app/state;
import app/note;
import app/editor;
import app/vaultPage;

export {
  makeApp() -> MAppStructure;
}

makeApp() -> MAppStructure {

  // Initial work with data

  state = makeInitialState();
  leftNavExpanderB = make(false);

  // UI elements

  buttonTexts = [
    Pair("Vault", PageTypeVault()),
  ];

  pageButtonsList = MLines(map(buttonTexts, \btn -> MTextButton(
    btn.first,
    \ -> {
      next(state.currentPageB, btn.second);
      reverseBehaviour(leftNavExpanderB);
    },
    [],
    []
  )));

  page = MSelect(state.currentPageB, \currentPageType -> {
    switch (currentPageType) {
      PageTypeVault() : makePageVault(state);
      default : MText("default page", []);
    }
  });

  leftNavHeader = MSNSmallHead([MText("Test", [])]);
  leftNav = MLeftNav(
    MSideNav(
      MSNSmallHead([MText("This will be header", [])]),
      pageButtonsList,
      leftNavExpanderB,
      []
    ),
    leftNavExpanderB,
    []
  );

  topToolBar = MAppBar(
    MSelect(
      state.userB,
      \user -> MToolbar(leftNavExpanderB, MText("Notilda", []), [MText(formatString("Welcome, %1", [user.name]), [])], [])
    )
  );

  MAppStructure([MContent(page), leftNav, topToolBar], []);
}
